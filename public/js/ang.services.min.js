/*! Angular-Chat (c) Hermann RÃ¶sser License: MIT 2016-07-20 */
"use strict";angular.module("chatApp.services",[]).factory("soundService",function(){var audio=document.getElementById("chatAudio"),soundSources=(document.getElementById("speaker"),{joinSound:"",leaveSound:"",chatSound:"../sound/chat.ogg",privateMessageSound:""});return{playChatSound:function(type){if(!this.mute)switch(type){case"chatMsg":audio.src=soundSources.chatSound,audio.play();break;case"privMsg":audio.src=soundSources.privateMessageSound,audio.play()}},playPMSound:function(){audio.src=soundSources.privateMessageSound,this.mute||audio.play()},toggleSoundState:function(switchTo){"mute"==switchTo?(console.log("# soundservice: snd was ON, switch sound MUTE > arg:"+switchTo),this.mute=!0):(this.mute=!1,console.log("# soundservice : snd was OFF, switch sound ON typ: "+switchTo))},isMuted:function(){return this.mute},muteMe:function(){this.mute=!0},muteOff:function(){this.mute=!1}}}).factory("userService",function(){var userObj={chatName:"",setPrivate:!1,privateTo:"",loggedIn:!1};return{setUserObj:function(key,val){userObj[key]=val},getUserObj:function(key){return userObj[key]},isLoggedIn:function(){return userObj.loggedIn},isInPrivate:function(){return userObj.setPrivate},isPrivateTo:function(){return userObj.privateTo},logIn:function(){userObj.loggedIn=!0},logOut:function(){userObj.loggedIn=!1},setEntireUserObj:function(obj){userObj=obj},getEntireUserObj:function(){return userObj}}}).factory("handlerChatMessages",function(chatHelpers,appConf){var chatMessages=[];return{pushChatMessage:function(message){message.time=chatHelpers.formatTime(message.time),chatMessages.push(message),chatMessages.length>appConf.maxChatMessages&&chatMessages.slice(0,1)},getChatMessages:function(){return chatMessages},getChatMessage:function(index){return chatMessages[index]},resetChatMessages:function(){chatMessages=[]}}}).factory("handlerServerMessages",function(chatHelpers,appConf){var serverMessages=[];return{pushServerMessage:function(data){data.time=chatHelpers.formatTime(data.time),serverMessages.push(data),serverMessages.length>appConf.maxServerMessages&&(serverMessages=serverMessages.slice(1,serverMessages.length))},getServerMessages:function(){return serverMessages},getServerMessage:function(index){return serverMessages[index]},resetServerMessages:function(){serverMessages=[]}}}).factory("handlerUserlist",function(chatHelpers,userService){var userlist=[],singleUser={};return{setUsers:function(data){userlist=[];for(var i in data.users)singleUser={},singleUser.style="",singleUser.name=data.users[i],singleUser.index=i,userService.getUserObj("chatName")===data.users[i]?(singleUser.state="self",singleUser.style="online-user-current"):userService.isInPrivate&&userService.isPrivateTo===data.users[i]?(singleUser.state="privateTo",singleUser.style="online-user-pm"):(singleUser.state="norm",singleUser.style="online-user-norm"),userlist.push(singleUser)},toggleUserState:function(index,state,user){switch(state){case"norm":userlist[index].state="privateTo",userlist[index].style="online-user-pm",userService.setUserObj("setPrivate",!0),userService.setUserObj("privateTo",user);break;case"privateTo":userlist[index].state="norm",userlist[index].style="online-user-norm",userService.setUserObj("setPrivate",!1),userService.setUserObj("privateTo","")}},getUsers:function(){return userlist},getUserByIndex:function(index){return userlist[index]},resetUserlist:function(){userlist=[]}}});